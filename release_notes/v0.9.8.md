# Sage v0.9.8 Release Notes

**Release Date:** 2026-02-08
**Version:** v0.9.8

## üåü Overview
v0.9.8 marks a significant milestone in Sage's evolution from a local experimental framework to an **Enterprise-Grade Service Architecture**. This release introduces a robust storage layer (Elasticsearch, MinIO, SQL), a comprehensive RAG engine, security sandboxing, full observability with OpenTelemetry, and a groundbreaking **Fibre Agent** architecture.

## üß† New Agent Architecture: Fibre Agent
Introduced `FibreAgent`, a new parallel multi-agent orchestration mode designed for complex, dynamic task execution.
- **Parallel Orchestration**: Unlike the sequential `TaskExecutor`, `FibreAgent` uses an `Orchestrator` to manage multiple sub-agents ("Strands") running in parallel.
- **Dynamic Sub-Agents**: The main agent can dynamically spawn `FibreSubAgent` instances to handle sub-tasks independently.
- **Unified Context**: Maintains a shared session context while allowing sub-agents to operate with isolated workspaces and memories where needed.
- **Fibre Tools**: Specialized tools for agent-to-agent communication and task delegation.

## üèó Infrastructure & Architecture

### 1. Enterprise Storage Layer
- **Elasticsearch Integration**: Replaced simple vector stores with **Elasticsearch (v8.19)** for high-performance vector retrieval and hybrid search.
- **MinIO Object Storage**: Integrated **MinIO** for scalable file and object storage, replacing local file system dependencies in distributed setups.
- **SQL Persistence**: Adopted **SQLAlchemy** with support for SQLite (default) and MySQL (`aiomysql`) for robust metadata management.

### 2. Server Refactoring (MVC Pattern)
The `app/server` has been completely restructured into a layered architecture:
- **Core**: Centralized configuration, authentication (`auth.py`), and client management (DB, ES, MinIO).
- **Routers**: Modularized API endpoints for `Agent`, `Chat`, `Knowledge Base (KDB)`, `MCP`, `Skill`, `Trace`, and `User`.
- **Services**: Dedicated business logic layer separating concerns from API handling.
- **Models**: Unified data models for database entities.

### 3. Observability
- **OpenTelemetry Support**: Added full tracing support (`opentelemetry-api`, `opentelemetry-sdk`) to monitor request lifecycles and agent execution paths.
- **Trace Module**: New `trace` models and routers to visualize and debug agent interactions.

## ‚öôÔ∏è Core Framework Enhancements (`sagents`)

### 1. New RAG Engine (`retrieve_engine`)
A completely rewritten Retrieval-Augmented Generation engine featuring:
- **Modular Design**: Decoupled `Embedding`, `Splitter`, and `VectorStore` interfaces.
- **Advanced Retrieval**: Implemented **RRF (Reciprocal Rank Fusion)** for combining keyword and vector search results.
- **Pipeline Management**: New `KnowledgeManager` to orchestrate the indexing and retrieval workflow.

### 2. Security Sandbox (`sagents.utils.sandbox`)
- **Code Execution Sandbox**: Introduced a secure sandbox environment for executing agent-generated code.
- **Resource Limits**: Configurable memory and CPU limits to prevent resource exhaustion.
- **Process Isolation**: Enhanced isolation to protect the host system.

### 3. Skill System (`sagents.skill`)
- **Skill Manager**: A new dedicated manager for discovering, registering, and loading external skills (`skills/` directory).
- **Dynamic Loading**: Support for hot-loading skills and defining skill metadata (`SKILL.md`).

### 4. MCP (Model Context Protocol) Support
- **MCP Integration**: Native support for the Model Context Protocol (`mcp`, `fastmcp`), enabling standardized interaction with external tools and agents.

## üõ† Dependency Updates
Major additions to `requirements.txt`:
- **Storage**: `elasticsearch==8.19.0`, `minio>=7.2.0`, `SQLAlchemy>=2.0.0`
- **Async Drivers**: `aiosqlite`, `aiomysql`
- **Observability**: `opentelemetry-*`
- **Security**: `PyJWT`, `argon2-cffi` (for password hashing)
- **Utilities**: `tqdm`, `loguru`, `rank-bm25`

## ‚ö†Ô∏è Breaking Changes
1.  **Infrastructure Requirements**: Running the full server now requires **Elasticsearch** and **MinIO** (or compatible S3 service).
2.  **Configuration**: The configuration structure has changed to support the new clients. Ensure `config.py` or environment variables are updated.
3.  **API Endpoints**: API routes have been reorganized. Clients consuming the raw API should check the new Swagger/OpenAPI documentation.

## üìù Upgrade Instructions
1.  **Install System Dependencies**: Ensure you have access to an Elasticsearch instance and MinIO server.
2.  **Update Python Packages**:
    ```bash
    pip install -r requirements.txt
    ```
3.  **Database Migration**: The introduction of SQLAlchemy implies a database initialization step may be required (check `bootstrap.py` or startup logs).
4.  **Check Configuration**: Review `.env` or configuration files for new required fields (ES_URL, MINIO_ENDPOINT, DB_URL).
